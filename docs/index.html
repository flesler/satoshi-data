<!DOCTYPE html>
<html>
  <head>
    <title>Q&As of Satoshi Nakamoto</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style type="text/css">
      html, body { margin: 0; width: 100%; }
      #qas { padding-top: 20px; }
      .qa { border-bottom: 1px solid black; padding: 10px; }
      .ignore { background-color: #EEE; opacity: 0.7; }
      .ignore::before { content: "‚ùå"; }
      .favorite { background-color: lightyellow; }
      .favorite::before { content: "‚≠êÔ∏è"; }
      .gpt-4::before { content: "ü§ñ"; }

      #top-bar { position: fixed; top: 0; left: 0; right: 0; z-index: 2; text-align: center; background: white; padding: 5px 0; }
      .hide-ignored .ignore { display: none; }
      .only-favorites .qa:not(.favorite) { display: none; }
      p { margin: 10px 0 0 0; }
    </style>
  </head>
  <body>
    <div id="top-bar">
      <label><input type="radio" name="visibility" id="hide-ignored" checked="checked" /> Hide ignored</label>
      <label><input type="radio" name="visibility" id="show-ignored" /> Show ignored</label>
      <label><input type="radio" name="visibility" id="only-favorites" /> Only favorites</label>
    </div>
    <div id="qas"></div>
    <script type="text/javascript">
      const xhr = new XMLHttpRequest()
      xhr.onreadystatechange = () => {
        if (xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200) {
          renderQAs(JSON.parse(xhr.responseText))
        }
      }
      xhr.open('GET', './qa.json', true)
      xhr.send()

      const toHTML = (text) => {
        return text.replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\n/g, '<br/>')
      }
      const renderQAs = (qas) => {
        const html = qas.map(i => `<div class="qa ${i.type || ''}">
          <a id="${i.id}" href="#${i.id}">#${i.id}</a> - ${i.date} - <a href="${i.src}" target="_blank">${i.src}</a>
          <p><b>User</b> (${i.q.length} chars): ${toHTML(i.q)}</p>
          <p><b>Satoshi</b> (${i.a.length} chars): ${toHTML(i.a)}</p>
        </div>`).join('')
        document.getElementById('qas').innerHTML = html
      }
      const updateVisibility = () => {
        const radios = document.querySelectorAll('input[name=visibility]')
        document.body.className = [].find.call(radios, r => r.checked).id
      }
      updateVisibility()
      document.getElementById('top-bar').onclick = updateVisibility
    </script>
  </body>
</html>